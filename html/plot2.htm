<!DOCTYPE html>
<html>
<head>
<title>piTemp Konfiguration</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<META HTTP-EQUIV="Expires" CONTENT="-1">
<link rel="stylesheet" type="text/css" href="style.css">
<script src="../libraries/jquery-1.8.3.min.js" type="text/javascript"></script>
		<script src="http://code.jquery.com/jquery-1.8.3.min.js" type="text/javascript"></script>
		<script src="http://code.highcharts.com/highcharts.js" type="text/javascript"></script>
		<script type="text/javascript">

		var num_obs = 200;
      var chart; // global chart variable
      // Get data from server in JSON format (query time series when sensor was outside).
      function getData(){
         $.getJSON('/temperature_query.json?num_obs='+num_obs+'&start_date=2013-01-23T16:00', function(data){
            var series = {
               id: 'series',
               name: 'Flow 1',
               type: 'area',
               data: []
               };
            var series2 = {
               id: 'series2',
               name: 'Flow 2',
               type: 'area',
               data: []
               };			 
			   
            var i = 0;
            // Iterate JSON data series and add to plot
            while (data.temperature_record[0][i])
            {	
			   console.log(data.temperature_record[0][i].device);
			   if (data.temperature_record[0][i].device == 0) {
               series.data.push([data.temperature_record[0][i].time, data.temperature_record[0][i].temp]);
               i++;}
			   else if (data.temperature_record[0][i].device == 4) {
               series2.data.push([data.temperature_record[0][i].time, data.temperature_record[0][i].temp]);
               i++;}
			   
			   else {i++}
            }
         chart.addSeries(series);
		  chart.addSeries(series2);
         });
      }
	</script>

   <script type="text/javascript">
   // Configure the plot
   $(document).ready(function() {
      chart = new Highcharts.Chart({
         chart: {
            renderTo: 'graph',
            //type: 'spline',
            zoomType: 'x',
            spaceRight: 20,
            events: {load: getData()}
               },
        title: {
		       text: 'Flow #'},
               
        xAxis: {
		       type: 'datetime',
		       tickPixelInterval: 150,
		       maxZoom: 20 * 1000,
		       title: {
			      text: 'Time',
			      margin: 15
			   }},
         yAxis: {
		       minPadding: 0.2,
		       maxPadding: 0.2,
             showFirstLabel: false,
		       title: {
		           text: 'l per min',
		           margin: 15
		       }},
             plotOptions: {
                            area: {
                                fillColor: {
                                    linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1},
                                    stops: [
                                        [0, Highcharts.getOptions().colors[0]],
                                        [1, 'rgba(2,0,0,0)'],
                                    ]
                                },
                                lineWidth: 1,
                                marker: {
                                    enabled: false,
                                    states: {
                                        hover: {
                                            enabled: true,
                                            radius: 5
                                        }
                                    }
                                },
                                shadow: false,
                                states: {
                                    hover: {
                                        lineWidth: 1
                                    }
                                },
                                threshold: null
                            },
                       
                              
                        },
         })
   });        
	</script>	
</head>
<body>
<div id="container">
<img src="img/banner.png"/></a>
	<nav>
		<ul>
			<li><a href="multi.htm">view</a></li>
			<li><a href="plot.htm">graph</a></li>			
			<li><a href="plot2.htm">history</a></li>			
			<li><a href="config1.htm">config</a></li>
			<li><a href="config2.htm">config 2</a></li>
			<li><a href="bar.htm">barcode config</a></li>
		</ul>
	</nav>

	<section id="gdiv">
		<div id="graph" style="width: 100%; height: 400px"></div>
 	</section>
 <footer>		
 </footer>
</div>
</body>
</html>
