<!DOCTYPE html>
<html>
<head>
<link rel="icon" type="image/gif" href="img/favicon.png" />
<link rel="stylesheet" type="text/css" href="style.css">
<title>piTemp</title>
<script src="../libraries/jquery-1.8.3.min.js" type="text/javascript"></script>
<script src="../libraries/RGraph.common.core.js" ></script>
<script src="../libraries/RGraph.common.effects.js" ></script>
<script src="../libraries/RGraph.thermometer.js" ></script>
<script type="text/javascript">
var schalter = "off";													// Schalter initiieren 
var moehre = 0;		
aktiv = 0;
celsius = {};													// Schleifenz채hler nicht i!!! wird in graph-script verwendet 										
thermometer = new Array();

function lade(wahl){
if (wahl == "on") {
aktiv = setInterval(function(){getData()}, 2000);
	}
else if (wahl == "off") {clearInterval(aktiv)};
}
	
// Auswahl Benutzereingabe
function choose(choice){
	schalter = choice;
	if (document.getElementById('g0c').checked) {graph(schalter, celsius[1], "g1", 1);}
	if (document.getElementById('g1c').checked) {graph(schalter, celsius[2], "g2", 2);}
	if (document.getElementById('g2c').checked) {graph(schalter, celsius[3], "g3", 3);}
	if (document.getElementById('g3c').checked) {graph(schalter, celsius[4], "g4", 4);}
	if (document.getElementById('g5c').checked) {getData("g5",5)}
	if (document.getElementById('g6c').checked) {getData("g6",6)}
	if (document.getElementById('g7c').checked) {getData("g7",7)}
}

// Daten aus json lesen, abh채ngig von User Eingabe
function getData(){	
	var data;
	var jsonurl = './tnow.json';
	console.log('getData  | %o | Aufruf', schalter);
		$.ajax({
			type: "GET",
			url: jsonurl,													// Daten-Stream url
			data: data,														// Variable f체r json Container
			async: true,										
			dataType: "json",
			success: function(data){										// nur ausf체hren wenn getJson (hier ajax) erfolgreich war
				moehre++;
				celsius = data.temperature_record;
			},
			error: function(){alert('Der Server antwortet nicht!');}
			});	
}	
	
function graph (schalter, celsius, gid, tid) {	
	if (schalter == "on" || schalter == "update") {
		var value = celsius;
			if (typeof thermometer[tid] == 'undefined') {
				thermometer[tid]= new RGraph.Thermometer({id: gid, min: 0, max: 50, value: value});
			} 
			else {
				thermometer[tid].value = value;
			}
			thermometer[tid].grow()				
			}
		else if (schalter == "off")
		{
		}
		else if (schalter == "clear")
		{
		graph("on", 0.0, gid, tid);
		console.log("Graph    | %o", schalter);
		}
}

function graphinit() {
graph("on", 0.0, "g0", 0);
graph("on", 0.0, "g1", 1);
graph("on", 0.0, "g2", 2);
graph("on", 0.0, "g3", 3);
graph("on", 0.0, "g4", 4);
graph("on", 0.0, "g5", 5);
graph("on", 0.0, "g6", 6);
graph("on", 0.0, "g7", 7);
}
</script>
</head>
<body>
<div id="container">
<img src="img/banner.png"/></a>
	<nav>
		<ul>
			<li><a href="single.htm">read temperature</a></li>
			<li><a href="multi.htm">read multi temperature</a></li>
			<li><a href="check.htm">config</a></li>
		</ul>
	</nav>
  <aside>
	<div id="buttons">
		<b>choose device:</b>
		<p>
		Temp 1 <input id="g0c" name="g0c" type="checkbox" autocomplete="off"/><br>
		Temp 2 <input id="g1c" name="g1c" type="checkbox" autocomplete="off"/><br>
		Temp 3 <input id="g2c" name="g2c" type="checkbox"/><br>
		Temp 4 <input id="g3c" name="g3c" type="checkbox"/><br>
		Temp 5 <input id="g4c" name="g4c" type="checkbox"/><br>
		Temp 6 <input id="g5c" name="g5c" type="checkbox"/><br>
		Temp 7 <input id="g6c" name="g6c" type="checkbox"/><br>
		Temp 8 <input id="g7c" name="g7c" type="checkbox"/>
		<br>
		<p>
		<b>control device:</b>
		<br>
		<button onClick="choose('on')">On</button>
		<button onClick="choose('off')">Off</button>
		<br>
		<button onClick="choose('update')">update</button>
		<button onClick="choose('clear')">clear</button>
		<br>
		<br>
		<button onClick="lade('on')">Laden On</button>
		<button onClick="lade('off')">Laden Off</button>
	</div>	
</aside>
<section id="content">
	<article>	
		<div id="log">	
		<h1><span id="logback">Temperatur</span></h></div>
		<div id="temp">keine Daten</div>
		<canvas id="g0" width="80" height="300">[No canvas support]</canvas>
		<canvas id="g1" width="80" height="300">[No canvas support]</canvas> 
		<canvas id="g2" width="80" height="300">[No canvas support]</canvas> 
		<canvas id="g3" width="80" height="300">[No canvas support]</canvas> 
		<canvas id="g4" width="80" height="300">[No canvas support]</canvas> 
		<canvas id="g5" width="80" height="300">[No canvas support]</canvas> 
		<canvas id="g6" width="80" height="300">[No canvas support]</canvas> 
		<canvas id="g7" width="80" height="300">[No canvas support]</canvas> 
	</article>
  </section>
<footer>		
</footer>
</div>
	<script>graphinit(); var divvv = document.getElementById('logback');</script>
	</body>
</html>
